var backend="dml/dml_index.php";var token="";var version="1.0";var backend_license="https://amatech.id/license/index.php";var ac_timeout;var server_time;var st_interval;var func_onload;var navicon_onload;var resize_onload;var scroll_speed=50;var menu_speed=20;var body_scale=1;var scrollbarWidth=0;var scrollbarWidthScaled=0;var files_upload={};var saved_files_value={};var _clickForSort=false;var _clickForFilter=false;var top_interval;var down_interval;var top_menu;var _moveHover=false;var _moveNewHover=false;var _moveNewHover2=false;var _moveNewHover3=false;$(document).ready(function(){$(window).bind("load",resizeElements);$(window).bind("resize",resizeElements);$(window).bind("orientationchange",resizeElements);if(window.location.href.indexOf("login.php")==-1){var data={};data.act="get_time";data.params={};ajaxPost(data,function(resp){result=JSON.parse(resp);if(result['status']=="00000"){server_time=result['return']['time'];}else{var d=new Date();server_time=Math.floor(d.getTime()/1000);}
clearInterval(st_interval);setInterval(function(){server_time+=1;refreshServerDatetime();},1000);if(typeof func_onload==="function"){func_onload();}});}
$('#btnToggleGotoPage').click(function(){if($('#divGotoPageOuterContainer').is(":visible")){closeGotoPage();}else{openGotoPage();}});$('#selectActiveMonth').width(150).chosen({"disable_search":true,}).change(function(){var month=$(this).val();var data={};data.act="change_active_month";data.params={};data.params.month=month;ajaxPost(data,function(resp){var page=window.location.href.substr(window.location.href.lastIndexOf("/")+1);if(page.indexOf("?")>=0)page=page.substr(0,page.indexOf("?"));gotoPage(page);});});$('#selectActiveDepo').width(225).chosen({no_results_text:"KATA TIDAK DITEMUKAN",}).change(function(){var value=$(this).val();var data={};data.act="change_depo";data.params={};data.params.depo_id=value;ajaxPost(data,function(resp){var page=window.location.href.substr(window.location.href.lastIndexOf("/")+1);if(page.indexOf("?")>=0)page=page.substr(0,page.indexOf("?"));gotoPage(page);});});$('#btnMaintenanceMode').click(function(){var checked=$(this).prop("checked");if(checked){showInformation("KONFIRMASI","AKTIFKAN MAINTENANCE?<br>SEMUA PENGGUNA SELAIN ADMINISTRATOR TIDAK BISA MENGAKSES SELAMA PROSES MAINTENANCE BERLANGSUNG","OK","TIDAK","",function(){var data={};data.act="change_mode";data.params={};data.params.mode="on";ajaxPost(data,function(resp){var result=JSON.parse(resp);if(result['status']=="00000"){$('.titleMaintenance').removeClass("inactive");}else{showInformation("["+result['status']+"] KESALAHAN",result["message"],"OK","","",function(){$('#btnMaintenanceMode').prop("checked",false);});}});},function(){$('#btnMaintenanceMode').prop("checked",false);});}else{var data={};data.act="change_mode";data.params={};data.params.mode="off";ajaxPost(data,function(resp){var result=JSON.parse(resp);if(result['status']=="00000"){$('.titleMaintenance').addClass("inactive");}else{showInformation("["+result['status']+"] KESALAHAN",result["message"],"OK","","",function(){$('#btnMaintenanceMode').prop("checked",true);});}});}});$('#selectGotoPage').change(function(){closeGotoPage();gotoPage($(this).val());});$(document).keyup(function(e){if(e.which==70&&e.shiftKey){$('#btnToggleGotoPage').click();}
if(e.which==27){closeGotoPage();}});$('input, select').focus(function(){if($(this).prop('readonly'))$(this).blur();});setTimeout(function(){$('input[type="password"]').each(function(){var content="<span class='password-icon eye-slash'><img src='images/pass-hide.png'></span>";$(this).after(content);var eye=$(this).next();eye.find("img").css("margin-top","7px").show();});$('.password-icon').click(function(){if($(this).hasClass('eye-slash')){$(this).find('img').attr("src",'images/pass-show.png');$(this).removeClass('eye-slash');$(this).prev().attr("type","text");}else{$(this).find('img').attr("src",'images/pass-hide.png');$(this).addClass('eye-slash');$(this).prev().attr("type","password");}});},10);$('#divHeader .divTitleUser').click(function(){$('#divHoverProfile').toggle();$(document).mouseup(function(){$('#divHoverProfile').hide();$(this).off("mouseup");});});$('#divHeader .divTitleCompany').click(function(){$('#divHoverCompany').toggle();$('#divHoverCompany .cbDefault, #divHoverCompany .cbTitleDefault').prop("checked",false);$(document).mouseup(function(event){if($(event.target).parents("#divHoverCompany").length==0&&$(event.target).parents("#divInformation").length==0){$('#divHoverCompany').hide();$(this).off("mouseup");}});});$('.cbTitleDefault').click(function(){var obj=$(this);var checked=obj.is(":checked");var company_id=$(this).prop("id").split("-")[1];var is_default=1;var data={};data.act="change_default_company";data.params={};data.params.company_id=company_id;data.params.is_default=is_default;ajaxPost(data,function(resp){var result=JSON.parse(resp);if(result['status']=="00000"){$('#divCompanyMenu .tdCompanyTitle .status').remove();$('#divCompanyMenu .tdCompanyTitle').append("<div class='subtitle'>DEFAULT</div>");$('#divCompanyMenu .tdCompanyList .status, #divCompanyMenu .tdCompanyList .checkContainer').remove();$('#divCompanyMenu .tdCompanyList .action').each(function(){var this_company_id=$(this).prop("id").split("-")[1];if(this_company_id!=company_id)$(this).append("<label class='checkContainer'><input id='cbDefault-"+this_company_id+"' type='checkbox' class='cbDefault'>JADIKAN DEFAULT<span class='checkmark'></span></label>");});}else{showInformation("["+result['status']+"] KESALAHAN",result["message"],"OK","","",function(){obj.prop("checked",!checked);});}},function(){obj.prop("checked",!checked);});});$('#divCompanyMenu .cbMoveCompany').click(function(){var company_id=$(this).prop("id").split("-")[1];var is_default=1;if($('#cbDefault-'+company_id).size()>0){is_default=$('#cbDefault-'+company_id).prop("checked")?1:0;}
var data={};data.act="change_company";data.params={};data.params.company_id=company_id;data.params.is_default=is_default;ajaxPost(data,function(resp){var result=JSON.parse(resp);if(result['status']=="00000"){if(result['return']['eligible_months'].length>1){var warningDate=result['return']['eligible_months'][0]*1;setCookie("warning_date",warningDate,1);}
setCookie("top_menu",0,1);gotoPage("index.php");}else{showInformation("["+result['status']+"] KESALAHAN",result["message"],"OK");}});});$('#divHover #divHoverMove').click(function(){var obj=$(this).closest("#hoverHeader");var opened=obj.hasClass("open");if(opened){_moveHover=false;obj.removeClass("open");$(this).find("img").prop("src","images/lock.png");repositionHover();}else{obj.addClass("open");$(this).find("img").prop("src","images/lock-open.png");}});$('#hoverHeader').mousedown(function(e){if(!$(e.target).hasClass("click_to_toggle")){var opened=$(this).hasClass("open");if(opened){_moveHover=true;}}});$(document).mousedown(function(e){var opened=$('#hoverHeader').hasClass("open");if(opened){if(_moveHover){$('#divHover #tableHover').css("top",(e.clientY+$('#divHover #tableHover').height()/2-10)+"px");$('#divHover #tableHover').css("left",e.clientX+"px");}}}).mouseup(function(){var opened=$('#hoverHeader').hasClass("open");if(opened){_moveHover=false;}}).mousemove(function(e){var opened=$('#hoverHeader').hasClass("open");if(opened){e.preventDefault();if(_moveHover){$('#divHover #tableHover').css("top",(e.clientY+$('#divHover #tableHover').height()/2-10)+"px");$('#divHover #tableHover').css("left",e.clientX+"px");}}});$('#divNewHover #divNewHoverMove').click(function(){var obj=$(this).closest("#hoverNewHeader");var opened=obj.hasClass("open");if(opened){_moveNewHover=false;obj.removeClass("open");$(this).find("img").prop("src","images/lock.png");repositionNewHover();}else{obj.addClass("open");$(this).find("img").prop("src","images/lock-open.png");}});$('#hoverNewHeader').mousedown(function(e){if(!$(e.target).hasClass("click_to_toggle_new")){var opened=$(this).hasClass("open");if(opened){_moveNewHover=true;}}});$(document).mousedown(function(e){var opened=$('#hoverNewHeader').hasClass("open");if(opened){if(_moveNewHover){$('#divNewHover #tableNewHover').css("top",(e.clientY+$('#divNewHover #tableNewHover').height()/2-10)+"px");$('#divNewHover #tableNewHover').css("left",e.clientX+"px");}}}).mouseup(function(){var opened=$('#hoverNewHeader').hasClass("open");if(opened){_moveNewHover=false;}}).mousemove(function(e){var opened=$('#hoverNewHeader').hasClass("open");if(opened){e.preventDefault();if(_moveNewHover){$('#divNewHover #tableNewHover').css("top",(e.clientY+$('#divNewHover #tableNewHover').height()/2-10)+"px");$('#divNewHover #tableNewHover').css("left",e.clientX+"px");}}});$('#divNewHover2 #divNewHoverMove2').click(function(){var obj=$(this).closest("#hoverNewHeader2");var opened=obj.hasClass("open");if(opened){_moveNewHover2=false;obj.removeClass("open");$(this).find("img").prop("src","images/lock.png");repositionNewHover2();}else{obj.addClass("open");$(this).find("img").prop("src","images/lock-open.png");}});$('#hoverNewHeader2').mousedown(function(e){if(!$(e.target).hasClass("click_to_toggle_new_2")){var opened=$(this).hasClass("open");if(opened){_moveNewHover2=true;}}});$(document).mousedown(function(e){var opened=$('#hoverNewHeader2').hasClass("open");if(opened){if(_moveNewHover2){$('#divNewHover2 #tableNewHover2').css("top",(e.clientY+$('#divNewHover2 #tableNewHover2').height()/2-10)+"px");$('#divNewHover2 #tableNewHover2').css("left",e.clientX+"px");}}}).mouseup(function(){var opened=$('#hoverNewHeader2').hasClass("open");if(opened){_moveNewHover2=false;}}).mousemove(function(e){var opened=$('#hoverNewHeader2').hasClass("open");if(opened){e.preventDefault();if(_moveNewHover2){$('#divNewHover2 #tableNewHover2').css("top",(e.clientY+$('#divNewHover2 #tableNewHover2').height()/2-10)+"px");$('#divNewHover2 #tableNewHover2').css("left",e.clientX+"px");}}});$('#divNewHover3 #divNewHoverMove3').click(function(){var obj=$(this).closest("#hoverNewHeader3");var opened=obj.hasClass("open");if(opened){_moveNewHover3=false;obj.removeClass("open");$(this).find("img").prop("src","images/lock.png");repositionNewHover3();}else{obj.addClass("open");$(this).find("img").prop("src","images/lock-open.png");}});$('#hoverNewHeader3').mousedown(function(e){if(!$(e.target).hasClass("click_to_toggle_new_3")){var opened=$(this).hasClass("open");if(opened){_moveNewHover3=true;}}});$(document).mousedown(function(e){var opened=$('#hoverNewHeader3').hasClass("open");if(opened){if(_moveNewHover3){$('#divNewHover3 #tableNewHover3').css("top",(e.clientY+$('#divNewHover3 #tableNewHover3').height()/2-10)+"px");$('#divNewHover3 #tableNewHover3').css("left",e.clientX+"px");}}}).mouseup(function(){var opened=$('#hoverNewHeader3').hasClass("open");if(opened){_moveNewHover3=false;}}).mousemove(function(e){var opened=$('#hoverNewHeader3').hasClass("open");if(opened){e.preventDefault();if(_moveNewHover3){$('#divNewHover3 #tableNewHover3').css("top",(e.clientY+$('#divNewHover3 #tableNewHover3').height()/2-10)+"px");$('#divNewHover3 #tableNewHover3').css("left",e.clientX+"px");}}});$('#divMenu').on("mousewheel",function(event){var direction=event.originalEvent.wheelDelta>0?"top":"down";var top=$(this).css("margin-top").replace("px","")*1;event.preventDefault();if(direction=="top"&&top*-1-menu_speed<=0){$(this).css("margin-top","0px");checkMenuScroll();return}
if(direction=="down"&&top*-1+menu_speed+$('#divMenuScrollable').css("max-height").replace("px","")*1>=$(this).height()){$(this).css("margin-top","-"+($(this).height()-$('#divMenuScrollable').css("max-height").replace("px","")*1-1)+"px");checkMenuScroll();return}
$(this).css("margin-top",(top+menu_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta)))+"px");checkMenuScroll();});$('#divMenuScrollTop').hover(function(){clearInterval(top_interval);top_interval=setInterval(function(){var top=$('#divMenu').css("margin-top").replace("px","")*1;if(top*-1-menu_speed<=0){$('#divMenu').css("margin-top","0px");checkMenuScroll();return}
$('#divMenu').css("margin-top",(top+menu_speed)+"px");checkMenuScroll();},50);},function(){clearInterval(top_interval);});$('#divMenuScrollBottom').hover(function(){clearInterval(down_interval);down_interval=setInterval(function(){var top=$('#divMenu').css("margin-top").replace("px","")*1;if(top*-1+menu_speed+$('#divMenuScrollable').css("max-height").replace("px","")*1>=$('#divMenu').height()){$('#divMenu').css("margin-top","-"+($('#divMenu').height()-$('#divMenuScrollable').css("max-height").replace("px","")*1-1)+"px");checkMenuScroll();return}
$('#divMenu').css("margin-top",(top+menu_speed*-1)+"px");checkMenuScroll();},50);},function(){clearInterval(down_interval);});$('.divMenuCat').hover(function(){var id=$(this).prop("id").split("-")[1];$('#dhmc-'+id).show();var menuPosition=$('#dhmc-'+id).position().top;var menuHeight=$('#dhmc-'+id+'>.divHoverMenu').outerHeight();var marginTop=10;var wHeight=window.innerHeight/body_scale;if(menuPosition+menuHeight>wHeight)marginTop=marginTop+(wHeight-(menuPosition+menuHeight))-40;$('#dhmc-'+id+' .divHoverMenu').css("margin-top",marginTop+"px");},function(){var id=$(this).prop("id").split("-")[1];$('#dhmc-'+id).hide();});$('.divHoverShortMenu').click(function(){var path=$(this).data("path");if(path!==undefined){gotoPage(path);}});$('#divMenuTitle').click(function(){gotoPage("index.php");});var content="";content+="<span class='accancel'>";content+="<span>X</span>";content+="</span>";content+="<span class='acinfo'>";content+="<span>a..</span>";content+="</span>";content+="<div class='autoResultOuterContainer'>";content+="<div id='arc-"+$('.autoResultContainer').size()+"' class='autoResultContainer'>";content+="<img class='autoLoader' src='images/spinner.gif'>";content+="<div class='autoResult'></div>";content+="</div>";content+="</div>";$('.autocomplete').data("value","").data("oldvalue","").after(content);setTimeout(function(){$('.autocomplete').each(function(){var parent=$(this).parent();if(!parent.find('.acinfo').is(":visible")){parent.find('.acinfo').show();var top=parent.find('.autoResultOuterContainer').offset().top;var top2=$(this).offset().top;parent.find('.autoResultOuterContainer').css("margin-top",(top2-top+26)+"px");parent.find('.acinfo>span').css("top","0px");var top=parent.find('.acinfo>span').offset().top;parent.find('.acinfo>span').css("top",(top2-top)+"px");parent.find('.accancel>span').css("top",(top2-top)+"px");}});},100);$(document).on({keyup:function(e){var parent=$(this).parent();var _isPosting=$(this).hasClass("posting");var _isFreezing=$(this).hasClass("freezing");if(_isFreezing)return false;if(_isPosting)return false;var teks=$(this).val();var length=typeof $(this).data("length")!="undefined"?$(this).data("length"):3;if(e.which==38){return false;}else if(e.which==40){$(this).blur();return false;}else if(e.which==27){parent.find('.autoResultContainer').hide();return false}else if(e.which==13||teks.length>=length){clearTimeout(ac_timeout);var obj=$(this);ac_timeout=setTimeout(function(){var new_teks=obj.val().toUpperCase();if(new_teks.length>=length&&obj.is(":focus")){var check=obj.data("check");if(check!=new_teks){$('.autoResultContainer').hide();parent.find('.autoResultContainer').removeClass("borderless");var error_allowed="";var prefunc=obj.data("prefunc");if(typeof prefunc!="undefined"){error_allowed="TERJADI KESALAHAN TEKNIS";var fn=window[prefunc];if(typeof fn==="function"){error_allowed=fn(obj);}}
if(error_allowed==""){var act=obj.data("act");if(typeof act!="undefined"){var acts=act.split(".");obj.addClass("posting").data("check",new_teks);parent.find('.autoResultContainer').show().find('.autoResult').html("").parent().find('.autoLoader').show();scrollAutocompleteIntoView(obj);var data={};data.act=acts[0];data.params={};data.params.sub_act=acts[1];data.params.query=encodeURIComponent(addslashes(new_teks));var params=obj.data("params");if(typeof params!="undefined"&&params!=""){var sequences=params.split(",");for(var i=0;i<sequences.length;i++){var temp=sequences[i].split("=");data.params[temp[0]]=encodeURIComponent(addslashes(temp[1]));}}
ajaxPost(data,function(resp){obj.removeClass("posting");parent.find('.autoLoader').hide();result=JSON.parse(resp);if(result['status']=="00000"){createAutocompleteResult(parent,result['return']);}else{parent.find('.autoResultContainer').show().find('.autoResult').html("<div class='information'>["+result['status']+"] "+result["message"]+"</div>");}},function(error){obj.removeClass("posting").focus();parent.find('.autoLoader').hide();parent.find('.autoResultContainer').show().find('.autoResult').html("<div class='information'>TERJADI MASALAH SAAT PENGIRIMAN DATA</div>");},false,10,true);}else{parent.find('.autoResultContainer').show().find('.autoResult').html("<div class='information'>TERJADI KESALAHAN TEKNIS</div>");}}else{parent.find('.autoResultContainer').show().find('.autoResult').html("<div class='information'>"+error_allowed+"</div>");}}}},e.which==13?0:500);}else if(teks.length>=1){parent.find('.autoResultContainer').show().removeClass("borderless").find('.autoResult').html("<div class='information'>MASUKKAN MINIMAL "+length+" HURUF</div>");scrollAutocompleteIntoView($(this));}else if(teks.length<1){parent.find('.autoResultContainer').hide();}},keydown:function(e){var inp=String.fromCharCode(e.which);if(/[a-zA-Z0-9- ]/.test(inp)||e.which==13){$(this).data("check","");return true;}
if($.inArray(e.which,[38,40,27,8,46,37,39,35,36,9,222,187,189,186,188,190,191,221,219,220,96])>=0)return true;return false;},focus:function(e){var _isPosting=$(this).hasClass("posting");var _isFreezing=$(this).hasClass("freezing");if(_isPosting)return false;if(_isFreezing)return false;$('.autoResultContainer').hide();$(this).select();var parent=$(this).parent();var container=parent.find('.autoResultContainer');var length=typeof $(this).data("length")!="undefined"?$(this).data("length"):3;if(container.size()>0){if(length==0){$(this).keyup();container.show();scrollAutocompleteIntoView($(this));}else if($(this).val().length>=length){container.show();$(this).keyup();}else if($(this).val().length>=1){container.show();scrollAutocompleteIntoView($(this));}}}},'.autocomplete');$(document).on({click:function(){var obj=$(this);if(obj.parent().find('.autocomplete').prop("disabled")==false){if(obj.parent().find('.autocomplete').hasClass("freezing")){$('.autoResultContainer').hide();var oldvalue=obj.parent().find('.autocomplete').data("oldvalue");obj.parent().find('.accancel').hide();obj.parent().find('.autoResultContainer').show();obj.parent().find('.autocomplete').val(oldvalue).data("value","").data("oldvalue","").removeClass("freezing").prop("readonly",false);setTimeout(function(){obj.parent().find('.autocomplete').focus();},20);var outerTable=obj.parent().closest(".acscrollable");if(outerTable.size()>0){var innerTable=outerTable.find(">table");outerTable.stop().animate({scrollTop:obj.parent().offset().top-innerTable.position().top,},500);}
var callback=obj.parent().find('.autocomplete').data("cancel");var callback_data=obj.parent().find('.autocomplete').data("callback-value");var fn=window[callback];if(typeof fn==="function"){fn(callback_data);}}}}},'.accancel');$(document).keydown(function(e){var obj=$(this).find('.autoResultContainer:visible');if(obj.size()>0){var _isPosting=obj.hasClass("posting");var _isFreezing=obj.hasClass("freezing");if(_isPosting)return false;if(_isFreezing)return false;if(e.which==38||e.which==40||e.which==13||e.which==27){if(e.which==38){var selected=-1;if(obj.find('.selected').size()>0)selected=obj.find('.selected').prop('id').substr(3)*1-1;if(selected==-1){obj.find('.selected').removeClass("selected");obj.parent().parent().find('.autocomplete').focus();}else{if(obj.find('#tr-'+selected).size()>0){obj.find('.selected').removeClass("selected");obj.find('#tr-'+selected).addClass("selected");obj.find('.acscrollable').animate({scrollTop:selected*30-(obj.find('.acscrollable').height()/2-selected*5),},200);}}}else if(e.which==40){var selected=0;if(obj.find('.selected').size()>0)selected=obj.find('.selected').prop('id').substr(3)*1+1;if(obj.find('#tr-'+selected).size()>0){obj.find('.selected').removeClass("selected");obj.find('#tr-'+selected).addClass("selected");obj.find('.acscrollable').animate({scrollTop:selected*30-(obj.find('.acscrollable').height()/2-selected*5),},200);}}else if(e.which==13){if(obj.find('.selected').size()>0){var ac=obj.parent().parent().find('.autocomplete');if(!ac.is(":focus")){chooseAutocomplete(obj.parent().parent().find('.autocomplete'));}}}else if(e.which==27){obj.hide();obj.parent().parent().find('.autocomplete').focus();}
return false;}}}).click(function(event){var obj=$(this).find('.autoResultContainer:visible');if(obj.size()>0){if($(event.target).parents('div#'+obj.prop("id")).length==0&&$(event.target).next().next().next().find('.autoResultContainer').prop("id")!=obj.prop("id")){obj.hide();}}});$(document).on({mouseenter:function(){$(this).parent().find(".selected").removeClass("selected");$(this).addClass("selected");},mouseleave:function(){$(this).removeClass("selected");},click:function(){var obj=$(this).closest('.autoResultContainer');chooseAutocomplete(obj.parent().parent().find('.autocomplete'));}},'.autoTblScroll tr');});function closeGotoPage(){if($('#divGotoPageOuterContainer').is(":visible")){$('#btnToggleGotoPage').removeClass("rotate");$('#divGotoPageOuterContainer').hide();}}
function openGotoPage(){if(!$('#divGotoPageOuterContainer').is(":visible")&&!$('#divLoader').is(":visible")&&!$('#divInformation').is(":visible")&&!$('#divHover').is(":visible")&&!$('#divNewHover').is(":visible")&&!$('#divNewHover2').is(":visible")&&!$('#divNewHover3').is(":visible")){$('#btnToggleGotoPage').addClass("rotate");$('#divGotoPageOuterContainer').show(50,function(){$('#selectGotoPage').width(350).chosen({no_results_text:"Kata tidak ditemukan",});$('#selectGotoPage_chosen').trigger('mousedown');});$(document).mouseup(function(event){if($(event.target).parents("div#divGotoPage").length==0&&$('#divGotoPageOuterContainer').is(":visible")){closeGotoPage();$(this).off("mouseup");}});}}
function resizeElements(){if(window.innerWidth<=1366){body_scale=0.85;if(window.innerWidth<=1024)body_scale=0.65;}else{$('#divNavicon').show();body_scale=1.0;}
if(!isMobile()){scrollBarWidth=17;scrollbarWidthScaled=scrollBarWidth/body_scale;}
$('#tblMainTemplate').width("100%");$('#divMenuContainer').height(window.innerHeight/body_scale);$('.scrollWidth').width(scrollbarWidthScaled);if($('#divMenuScrollable').size()>0){var wHeight=window.innerHeight/body_scale;var titleHeight=$('#divMenuTitle').height();var footerHeight=$('#divMenuFooter').height();var menuHeight=wHeight-titleHeight-footerHeight-90;$('#divMenuScrollable').css("max-height",menuHeight+"px").css("min-height",menuHeight+"px");top_menu=getCookie("top_menu")!==null?getCookie("top_menu")*1:0;$('#divMenu').css("margin-top",top_menu+"px").show();$('#divMenuScrollTop, #divMenuScrollBottom').show();checkMenuScroll();}
if(typeof resize_onload==="function"){resize_onload();}}
function refreshServerDatetime(){var dt=new Date(server_time*1000);var date=(dt.getDate()<10?"0"+dt.getDate():dt.getDate())+" "+getMonthsName(dt.getMonth()+1)+" "+dt.getFullYear();var time=(dt.getHours()<10?"0"+dt.getHours():dt.getHours())+":"+(dt.getMinutes()<10?"0"+dt.getMinutes():dt.getMinutes());$('#divServerDate').html(date);$('#divServerTime').html(time+" <span>WIB</span>");}
function createTrashbin(obj){obj.find('.trashbin').each(function(){var found=$(this).find(".icon-trash").size()>0;if(!found){var content='<div class="icon-trash">';content+='<div class="trash-lid"></div>';content+='<div class="trash-container"></div>';content+='<div class="trash-line-1"></div>';content+='<div class="trash-line-2"></div>';content+='<div class="trash-line-3"></div>';content+='</div>';$(this).html(content);}});}
function checkMenuScroll(){if($('#divMenu').size()>0){$('.divHoverMenuContainer').hide();$('#divMenuScrollTop, #divMenuScrollBottom').addClass("disabled");var top=$('#divMenu').css("margin-top").replace("px","")*-1;if(top>0){$('#divMenuScrollTop').removeClass("disabled");}
if(top+$('#divMenuScrollable').height()<$('#divMenu').height()-5){$('#divMenuScrollBottom').removeClass("disabled");}}}
function createAutocomplete(obj){obj.find('.autocomplete').each(function(){if(!$(this).next().hasClass('accancel')){var content="";content+="<span class='accancel'>";content+="<span>X</span>";content+="</span>";content+="<span class='acinfo'>";content+="<span>a..</span>";content+="</span>";content+="<div class='autoResultOuterContainer'>";content+="<div id='arc-"+$('.autoResultContainer').size()+"' class='autoResultContainer'>";content+="<img class='autoLoader' src='images/spinner.gif'>";content+="<div class='autoResult'></div>";content+="</div>";content+="</div>";$(this).data("value","").data("oldvalue","").after(content);}});setTimeout(function(){obj.find('.autocomplete').each(function(){var parent=$(this).parent();if(!parent.find('.acinfo').is(":visible")){parent.find('.acinfo').show();var top=parent.find('.autoResultOuterContainer').offset().top;var top2=$(this).offset().top;parent.find('.autoResultOuterContainer').css("margin-top",(top2-top+26)+"px");parent.find('.acinfo>span').css("top","0px");var top=parent.find('.acinfo>span').offset().top;parent.find('.acinfo>span').css("top",(top2-top)+"px");parent.find('.accancel>span').css("top",(top2-top)+"px");}});},100);}
function scrollAutocompleteIntoView(obj){var parent=obj.parent();var outerTable=parent.closest(".scrollable");if(outerTable.size()>0){var innerTable=outerTable.find(">table");var targetTop=(parent.offset().top-innerTable.position().top)-outerTable.height()/2+37;if(targetTop>outerTable.scrollTop()){outerTable.stop().animate({scrollTop:targetTop,},500);}
var container=parent.find(".autoResultOuterContainer");var containerHeight=container.find('.autoResultContainer').height();if(targetTop+containerHeight>innerTable.height()&&targetTop-containerHeight>=0){container.css("top","-"+(28+containerHeight)+"px");}else{container.css("top","0px");}}}
function createAutocompleteResult(obj,resp){var data=resp.data;var header=resp.header;if(data.length>0){var content="<table class='autoTblResult'>";content+="<tr class='rheader'>";for(var params in header){content+="<th style='width:"+(header[params]['width']-2)+"px;max-width:"+(header[params]['width']-2)+"px;min-width:"+(header[params]['width']-2)+"px'>"+params+"</th>";}
content+="<th></th>";content+="</tr>";content+="<tr><td colspan=99>";content+="<div class='acscrollable'>";content+="<table class='autoTblScroll'>"
for(var i=0;i<data.length;i++){content+="<tr class='"+(i%2==0?"even":"odd")+"' id='tr-"+i+"' data-value='"+escape(data[i]['value'])+"' data-show='"+escape(data[i]['show'])+"' data-callback-value='"+escape(data[i]['callback_data'])+"'>";for(var params in header){content+="<td align='"+header[params]['align']+"' style='width:"+(header[params]['width']-16)+"px;max-width:"+(header[params]['width']-16)+"px;min-width:"+(header[params]['width']-16)+"px'>"+data[i][params]+"</td>";}
content+="</tr>";}
content+="</table>";content+="</div>";content+="</td></tr>";content+="</table>";obj.find(".autoResult").html(content);obj.find(".autoResultContainer").addClass("borderless");var maxHeight=typeof obj.find(".autocomplete").data("height")!="undefined"?obj.find(".autocomplete").data("height"):300;obj.find(".autoResult .acscrollable").css("maxHeight",maxHeight+"px");scrollAutocompleteIntoView(obj);var callback=obj.find(".autocomplete").data("show");var fn=window[callback];if(typeof fn==="function"){fn(obj.find(".autocomplete"));}}else{obj.find(".autoResult").html("<div class='information'>TIDAK ADA DATA DITEMUKAN</div>");}}
function chooseAutocomplete(obj,data){data=typeof data!=='undefined'?data:{};var oldvalue=obj.val();var callback=obj.data("choose");var show=unescape(obj.parent().find('.autoResultContainer .selected').data("show"));if(typeof data['show']!="undefined")show=data['show'];var value=unescape(obj.parent().find('.autoResultContainer .selected').data("value"));if(typeof data['value']!="undefined")value=data['value'];var callback_data=unescape(obj.parent().find('.autoResultContainer .selected').data("callback-value"));if(typeof data['callback_data']!="undefined")callback_data=data['callback_data'];obj.data("value",value).data("oldvalue",oldvalue).val(show).data("callback-value",callback_data).addClass("freezing").prop("readonly",true);obj.parent().find('.accancel').show();obj.parent().find('.autoResultContainer').hide();var fn=window[callback];if(typeof fn==="function"){fn(callback_data);}}
function loadVisualScrollReport(objName,currentSort,currentFilter){currentSort=typeof currentSort!=='undefined'?currentSort:"";currentFilter=typeof currentFilter!=='undefined'?currentFilter:{};var obj=$(''+objName);if(obj.size()>0){obj.find('.scrollable').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();$(this).scrollLeft($(this).scrollLeft()+(scroll_speed*2)*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}}).off("scroll").scroll(function(event){var x=$(this).scrollLeft();obj.find('.unscrollable').each(function(){$(this).scrollLeft(x);});});var filterRow=[];var has_filter=false;obj.find(".tblReport>tbody>tr>th").each(function(){var sort=$(this).data("sort");if(sort!==undefined){if(!$(this).hasClass("hasSort")){var id=$(this).prop("id");var fn=window[sort];var oldContent=$(this).html();var content="<table>";content+="<tr>";content+="<td class='sorting "+(currentSort==id+" ASC"?"chosen":"")+"' data-callback='"+sort+"' data-target='"+id+"' data-mode='ASC' onClick='doSortScrollReport(this)'>&#x25b2;</td>";content+="<td>"+oldContent+"</td>";content+="<td class='sorting "+(currentSort==id+" DESC"?"chosen":"")+"' data-callback='"+sort+"' data-target='"+id+"' data-mode='DESC' onClick='doSortScrollReport(this)'>&#x25bc;</td>";content+="</tr>";content+="</table>";$(this).html(content).addClass("hasSort");}}
var filter=$(this).data("filter");if(filter!==undefined){if(!$(this).hasClass("hasFilter")){var id=$(this).prop("id");var content="<input type='text' class='inpFilter "+(typeof currentFilter[id]!="undefined"&&currentFilter[id]!=""?"hasValue":"")+"' data-callback='"+filter+"' data-target='"+id+"' onFocus='focusFilterScrollReport(this)' onKeyup='keyupFilterScrollReport(this, event)' onBlur='doFilterScrollReport(this)' value='"+(typeof currentFilter[id]!="undefined"?escapeHtml(stripslashes(decodeURIComponent(currentFilter[id]))):"")+"'>";content+="<div class='btnFilterContainer'><button class='btnFilter' onClick='clearFilterScrollReport(this)'>x</button></div>";$(this).append(content).addClass("hasFilter");var inpFilter=$(this).find('.inpFilter');var height=inpFilter.height();var top=inpFilter.offset().top;var btnFilter=$(this).find('.btnFilter');var bTop=btnFilter.offset().top;btnFilter.css("height",height+"px").css("top","-"+(bTop-top)+"px");}}});}}
function doSortScrollReport(el){var obj=$(el);if(obj.size()>0){var callback=obj.data("callback");var target=obj.data("target");var mode=obj.data("mode");var fn=window[callback];obj.closest('.tblReport').find('.sorting').removeClass("chosen");obj.addClass("chosen");if(typeof fn==="function"){fn(target,mode);}}}
function focusFilterScrollReport(el){var obj=$(el);if(obj.size()>0){obj.select();obj.data("oldvalue",obj.val());}}
function keyupFilterScrollReport(el,evt){var obj=$(el);if(obj.size()>0){var charCode=(evt.which)?evt.which:event.keyCode;if(charCode==13)obj.blur();}}
function doFilterScrollReport(el){var obj=$(el);if(obj.size()>0){var callback=obj.data("callback");var target=obj.data("target");var oldvalue=obj.data("oldvalue");var fn=window[callback];if(obj.val()=="")obj.removeClass("hasValue");else obj.addClass("hasValue");if(typeof fn==="function"&&obj.val()!=oldvalue){fn(target,obj.val());}}}
function clearFilterScrollReport(el){var obj=$(el);if(obj.size()>0){var input=obj.parent().prev();input.data("oldvalue",input.val());input.val("");doFilterScrollReport(input);}}
function refreshSizeScrollReport(objName,maxWidth,maxHeight){var obj=$(''+objName);if(obj.size()>0){$('#divPageContainer').width(99999);obj.find(".scrollable").css("maxWidth","99999px");if(maxWidth>0&&obj.width()>maxWidth){var width=obj.find(".unscrollable>table").width()-scrollbarWidthScaled;obj.find(".scrollable").css("maxWidth",maxWidth+"px");obj.find(".scrollable>table").width(width);obj.find(".unscrollable").width(maxWidth-scrollbarWidthScaled);obj.find(".unscrollable>table").width(width+scrollbarWidthScaled);}
if(obj.find(".unscrollable").width()+scrollbarWidthScaled<obj.find(".scrollable").width()){obj.find(".unscrollable").width(obj.find(".scrollable").width()-scrollbarWidthScaled);}
var width=window.innerWidth/body_scale-$('#divMenuContainer').width()-40/body_scale;$('#divPageContainer').width(width);obj.find(".scrollable").css("maxHeight","none");if(maxHeight>0&&obj.height()>maxHeight){obj.find(".scrollable").css("maxHeight",maxHeight+"px");}}}
function loadUpload(objName){var obj=$(''+objName);if(obj.size()>0){if(obj.next().hasClass("select_multifile")==false&&obj.next().hasClass("select_file")==false){var width=obj.data("width");if(typeof width=="undefined")width=150;var text=obj.data("text");if(typeof text=="undefined")text="PILIH BERKAS";var id=obj.prop("id");files_upload[id]=[];saved_files_value[id]=[];var multiple=obj.prop("multiple");if(multiple){obj.after("<select id='multifile_"+id+"' class='select_multifile' multiple disabled></select>");var selectEl=obj.next();selectEl.width(width).chosen({placeholder_text_multiple:text,});var chosenEl=obj.next().next();chosenEl.click(function(){obj.click();});selectEl.change(function(){var id=$(this).prev().prop("id");var values=$(this).val();var diff=saved_files_value[id].diff(values);files_upload[id].splice(diff[0],1);refreshSelectUpload(objName);$(this).prop("disabled",true).trigger("chosen:updated");});obj.change(function(){var local_files=$(this)[0].files;for(var i=0;i<local_files.length;i++){var found=false;for(var j=0;j<files_upload[id].length;j++){if(local_files[i].name==files_upload[id][j].name&&local_files[i].lastModified==files_upload[id][j].lastModified){found=true;break;}}
if(!found)files_upload[id].push(local_files[i]);}
refreshSelectUpload(objName);});}else{obj.after("<input id='file_"+id+"' type='text' class='select_file' size=30 placeholder='"+text+"' readonly>");var inputEl=obj.next();inputEl.click(function(){$(this).blur();obj.click();});var id=obj.prop("id");obj.change(function(){var local_files=$(this)[0].files;if(local_files.length>0){files_upload[id][0]=local_files[0];obj.next().val(files_upload[id][0].name);}else{files_upload[id]=[];obj.next().val("");}});}}}}
function refreshSelectUpload(objName){var obj=$(''+objName);var id=obj.prop("id");if(typeof files_upload[id]!="undefined"){var content="";saved_files_value[id]=[];for(var i=0;i<files_upload[id].length;i++){saved_files_value[id].push(i+"");content+="<option value='"+i+"'>"+files_upload[id][i]['name']+"</option>";}
$('#'+id).next().html(content).val(saved_files_value[id]).trigger("chosen:updated");obj.val("");}}
function loadVisualMainReport(objName,currentSort,currentFilter){currentSort=typeof currentSort!=='undefined'?currentSort:"";currentFilter=typeof currentFilter!=='undefined'?currentFilter:{};var obj=$(''+objName);var no_data=obj.find(".report_data").size()>0?false:true;obj.find('>tbody>tr:last-child>td:first-child table').off('mousewheel').on('mousewheel',function(event){var scrollable=obj.find(".scrollable");scrollable.scrollTop(scrollable.scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);});obj.find('.scrollable').off("mousewheel").on("mousewheel",function(event){event.preventDefault();if(event.ctrlKey){$(this).scrollLeft($(this).scrollLeft()+(scroll_speed*2)*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}}).off("scroll").scroll(function(event){var x=$(this).scrollLeft();var y=$(this).scrollTop();obj.find('>tbody>tr:last-child>td:first-child>div').each(function(){$(this).scrollTop(y);});obj.find('>tbody>tr:first-child>td:last-child>div').each(function(){$(this).scrollLeft(x);});});obj.find(">tbody>tr:first-child>td>div>table>tbody>tr>th").each(function(){var data_sort=$(this).data("sort");var data_sort_callback=$(this).data("sort-callback");if(typeof data_sort!="undefined"&&typeof data_sort_callback!="undefined"){if(!$(this).hasClass("hasSort")){var oldContent=$(this).html();var content="<table>";content+="<tr>";content+="<td class='sorting "+(currentSort==data_sort+" ASC"?"chosen":"")+"' data-callback='"+data_sort_callback+"' data-target='"+data_sort+"' data-mode='ASC' onClick='doSortMainReport(this)'>&#x25b2;</td>";content+="<td>"+oldContent+"</td>";content+="<td class='sorting "+(currentSort==data_sort+" DESC"?"chosen":"")+"' data-callback='"+data_sort_callback+"' data-target='"+data_sort+"' data-mode='DESC' onClick='doSortMainReport(this)'>&#x25bc;</td>";content+="</tr>";content+="</table>";$(this).html(content).addClass("hasSort");}}
var data_filter=$(this).data("filter");var data_filter_callback=$(this).data("filter-callback");if(typeof data_filter!="undefined"&&typeof data_filter_callback!="undefined"){if(!$(this).hasClass("hasFilter")){var content="<input type='text' class='inpFilter "+(typeof currentFilter[data_filter]!="undefined"&&currentFilter[data_filter]!=""?"hasValue":"")+"' data-callback='"+data_filter_callback+"' data-target='"+data_filter+"' onFocus='focusFilterMainReport(this)' onKeyup='keyupFilterMainReport(this, event)' onBlur='doFilterMainReport(this)' value='"+(typeof currentFilter[data_filter]!="undefined"?escapeHtml(stripslashes(decodeURIComponent(currentFilter[data_filter]))):"")+"'>";content+="<div class='btnFilterContainer'><button class='btnFilter "+($(this).hasClass("hide_col")?"not_positioned_yet":"")+"' onClick='clearFilterMainReport(this)'>x</button></div>";$(this).append(content).addClass("hasFilter");if(!$(this).hasClass("hide_col")){var height=$(this).find('.inpFilter').height();$(this).find(".btnFilter").css("height",height+"px").css("top","-"+(height+1)+"px");}}}});obj.find('.sorting').unbind('mouseenter mouseleave').hover(function(){$(this).parent().parent().parent().parent().find('.icon_collapse').addClass('collapse_normal');},function(){$(this).parent().parent().parent().parent().find('.icon_collapse').removeClass('collapse_normal');});obj.find('.collapse_col_parent').each(function(){var id=$(this).prop("id");var direction=$(this).hasClass("arrow-left")?"left":"right";if($(this).find(".icon_collapse").size()==0){$(this).append("<div class='icon_collapse'><div>"+(direction=="right"?"&#129094;":"&#129092;")+"</div></div>");if(!$('.'+id).hasClass("hide_col")){var width=$(this).find('.icon_collapse').width();$(this).find('.icon_collapse>div').animate({left:direction=="right"?(width-18)+"px":"-2px",},100);}else{var width=$(this).find('.icon_collapse').width();$(this).find('.icon_collapse>div').animate({left:(width/2-10)+"px",},100);}}}).off("click").click(function(){if(_clickForSort){_clickForSort=false;return}
if(_clickForFilter){_clickForFilter=false;return}
var id=$(this).prop("id");var width=$(this).find('.icon_collapse').width();var direction=$(this).hasClass("arrow-left")?"left":"right";if(!no_data){if($('.'+id).size()>0){if($('.'+id).is(":visible")){var width=$(this).find('.icon_collapse').width();$('.'+id).addClass("hide_col");$(this).find('.icon_collapse>div').animate({left:(width/2-10)+"px",},100);}else{var width=$(this).find('.icon_collapse').width();$('.'+id).removeClass("hide_col").find('.not_positioned_yet').each(function(){var height=$(this).closest('.'+id).find('.inpFilter').height();$(this).css("height",height+"px").css("top","-"+(height+1)+"px");$(this).removeClass(".not_positioned_yet");});$(this).find('.icon_collapse>div').animate({left:direction=="right"?(width-18)+"px":"-2px",},100);}
refreshSizeMainReport(objName);}}});obj.find('.collapse_row_parent').each(function(){var id=$(this).prop("id");var count=$('.'+id).size();if($(this).find('.table_collapse').size()==0){var oldContent=$(this).find(">div").html();var content="<table class='table_collapse'>";content+="<tr>";content+="<td>"+oldContent+"</td>";content+="<td>"+(count>0?"&#9650;":"")+"</td>";content+="</tr>";content+="</table>";$(this).find(">div").html(content);if(!$('.'+id).hasClass("hide_row")){$(this).find('.table_collapse>tbody>tr>td:last-child').addClass("rotate");}else{$(this).find('.table_collapse>tbody>tr>td:last-child').removeClass("rotate");}}}).off("click").click(function(){var id=$(this).prop("id");if($('.'+id).size()>0){if($('.'+id).is(":visible")){$('.'+id).addClass("hide_row");$(this).find('.table_collapse>tbody>tr>td:last-child').removeClass("rotate");}else{$('.'+id).removeClass("hide_row");$(this).find('.table_collapse>tbody>tr>td:last-child').addClass("rotate");}
refreshSizeMainReport(objName);}});refreshSizeMainReport(objName);}
function doSortMainReport(el){var obj=$(el);if(obj.size()>0){var callback=obj.data("callback");var target=obj.data("target");var mode=obj.data("mode");var fn=window[callback];obj.closest('.tblMainReport').find('.sorting').removeClass("chosen");obj.addClass("chosen");if(typeof fn==="function"){fn(target,mode);}}
_clickForSort=true;}
function focusFilterMainReport(el){var obj=$(el);if(obj.size()>0){obj.select();obj.data("oldvalue",obj.val());}
_clickForFilter=true;}
function keyupFilterMainReport(el,evt){var obj=$(el);if(obj.size()>0){var charCode=(evt.which)?evt.which:event.keyCode;if(charCode==13)obj.blur();}}
function doFilterMainReport(el){var obj=$(el);if(obj.size()>0){var callback=obj.data("callback");var target=obj.data("target");var oldvalue=obj.data("oldvalue");var fn=window[callback];if(obj.val()=="")obj.removeClass("hasValue");else obj.addClass("hasValue");if(typeof fn==="function"&&obj.val()!=oldvalue){fn(target,obj.val());}}}
function clearFilterMainReport(el){var obj=$(el);if(obj.size()>0){var input=obj.parent().prev();input.data("oldvalue",input.val());input.val("");doFilterMainReport(input);}
_clickForFilter=true;}
function refreshSizeMainReport(objName){var obj=$(''+objName);var no_data=obj.find(".report_data").size()>0?false:true;if(obj.size()>0){var wWindow=window.innerWidth/body_scale;var wContainer=$('#divMenuContainer').width();var maxWidth=50;obj.find(".scrollable").css("maxWidth",maxWidth+"px");if(no_data){var wHeader=obj.find('>tbody>tr:first-child>td:last-child>div>table').width();obj.find('>tbody>tr:first-child>td:last-child>div').css("maxWidth",(maxWidth-17)+"px");obj.find('>tbody>tr:first-child>td:last-child>div>table').width(wHeader);}else{var wData=obj.find('>tbody>tr:last-child>td:last-child>div>table').width();obj.find('>tbody>tr:first-child>td:last-child>div>table').width(wData+17);obj.find('>tbody>tr:first-child>td:last-child>div').css("maxWidth",(maxWidth-17)+"px");}
var wWindow=window.innerWidth/body_scale;var wContainer=$('#divMenuContainer').width();var wFirst=obj.find('>tbody>tr:first-child>td:first-child>div>table').width();var maxWidth=wWindow-wContainer-wFirst-60;obj.find(".scrollable").css("maxWidth",maxWidth+"px");if(no_data){var wHeader=obj.find('>tbody>tr:first-child>td:last-child>div>table').width();obj.find('>tbody>tr:first-child>td:last-child>div').css("maxWidth",(maxWidth-17)+"px");obj.find('>tbody>tr:first-child>td:last-child>div>table').width(wHeader);}else{var wData=obj.find('>tbody>tr:last-child>td:last-child>div>table').width();obj.find('>tbody>tr:first-child>td:last-child>div>table').width(wData+17);obj.find('>tbody>tr:first-child>td:last-child>div').css("maxWidth",(maxWidth-17)+"px");}
var hWindow=window.innerHeight/body_scale;var hSelector=$('#divSelector').outerHeight();var hInput=$('#divInput').outerHeight();var hHeader=$('#divHeader').outerHeight();var hSetting=$('#divSetting').outerHeight();var hHeaderTable=obj.find('>tbody>tr:first-child>td:last-child table').height();var maxHeight=hWindow-hSelector-hInput-hHeader-hSetting-hHeaderTable-80;obj.find(".scrollable").css("maxHeight",maxHeight+"px");obj.find('>tbody>tr:last-child>td:first-child>div').css("maxHeight",(maxHeight-17)+"px");if(no_data){var width=obj.find('>tbody>tr:first-child>td:first-child>div>table').width();obj.find('>tbody>tr:last-child>td:first-child>div>table').width(width);obj.find('>tbody>tr:first-child>td:first-child>div>table').width(width);var minWidth=obj.find('>tbody>tr:first-child>td:last-child>div>table').width();obj.find(".scrollable").width(minWidth);obj.find(".scrollable>table").width(minWidth-17);}}}
function checkBarcodeBaru(barcode){if(barcode.trim().length==18||barcode.trim().length==22){if(barcode.match(/^[0-9]+$/)!=null){var tahun=0;var bulan=0;if(barcode.trim().length==18){tahun=barcode.substr(11,2);bulan=barcode.substr(13,2);}else{tahun=barcode.substr(15,2);bulan=barcode.substr(17,2);}
if(tahun.match(/^[0-9]+$/)!=null&&tahun*1>=5){if(bulan.match(/^[0-9]+$/)!=null&&bulan*1>=1&&bulan*1<=12){return true;}else{return false;}}else{return false;}}else{return false;}}else{return false;}}
function checkBarcodeLama(barcode){if(barcode.trim().length>=15&&barcode.trim().length<=18){if(barcode.match(/^[0-9a-zA-Z]+$/)!=null){var tahun=barcode.substr(7,2);var bulan=barcode.substr(9,2);var temp_valid=true;if(tahun.match(/^[0-9]+$/)!=null&&tahun*1>=5){if(bulan.match(/^[0-9]+$/)!=null&&bulan*1>=1&&bulan*1<=12){return true;}else{temp_valid=false;}}else{temp_valid=false;}
if(!temp_valid){if(barcode.trim().length==18){tahun=barcode.substr(11,2);bulan=barcode.substr(13,2);if(tahun.match(/^[0-9]+$/)!=null&&tahun*1>=5){if(bulan.match(/^[0-9]+$/)!=null&&bulan*1>=1&&bulan*1<=12){return true;}else{return false;}}else{return false;}}else{return false;}}else{return false;}}else{return false;}}else{return false;}}
function checkBatchYear(batch,limitYear){var is_old=false;if(limitYear>0&&batch!=""&&batch.length>=15&&batch.length<=22){var tahun=batch.substr(7,2);var bulan=batch.substr(9,2);if(batch.trim().length==18){tahun=batch.substr(11,2);bulan=batch.substr(13,2);}else if(batch.trim().length==22){tahun=batch.substr(15,2);bulan=batch.substr(17,2);}
var batchYear=("20"+tahun+bulan)*1;if(batchYear<=limitYear)is_old=true;}
return is_old;}
function getTerbilang(stockEcer,packQty,satuanUnit){if(satuanUnit=="")satuanUnit="UNIT";if(packQty==0)packQty=1;terbilang="";pack=Math.floor(stockEcer/packQty)*1;ecer=(stockEcer%packQty)*1;if(pack*1>0){if(packQty==1)terbilang+=formatCur(pack)+" "+satuanUnit;else terbilang+=formatCur(pack)+" PACK ";}
if(ecer*1>0){terbilang+=formatCur(ecer)+" "+satuanUnit;}
if(terbilang==""){terbilang="0 "+satuanUnit;}
return terbilang;}
Array.prototype.diff=function(a){if(a==null)return this;return this.filter(function(i){return a.indexOf(i)<0;});};jQuery.fn.highlight=function(delay,bgcolor,showAndFocus){showAndFocus=typeof showAndFocus!=='undefined'?showAndFocus:true;$(this).each(function(){var el=$(this);if(showAndFocus)el[0].scrollIntoView();$("<div class='highlight' />").width(el.outerWidth()).height(el.outerHeight()).css({"position":"absolute","left":el.offset().left,"top":el.offset().top,"background-color":bgcolor,"opacity":".7","z-index":"9999999","border-top-left-radius":parseInt(el.css("borderTopLeftRadius"),10),"border-top-right-radius":parseInt(el.css("borderTopRightRadius"),10),"border-bottom-left-radius":parseInt(el.css("borderBottomLeftRadius"),10),"border-bottom-right-radius":parseInt(el.css("borderBottomRightRadius"),10)}).appendTo('body').fadeOut(delay).queue(function(){$(this).remove();});});}
function showInformation(title,message,btnYesText,btnNoText,btnCancelText,callbackYes,callbackNo,callbackCancel){title=typeof title!=='undefined'?title:"INFORMASI";message=typeof message!=='undefined'?message:"INI PESAN DEFAULT";btnYesText=typeof btnYesText!=='undefined'?btnYesText:"OK";btnNoText=typeof btnNoText!=='undefined'?btnNoText:"";btnCancelText=typeof btnCancelText!=='undefined'?btnCancelText:"";setCallbackYes=typeof callbackYes!=='undefined'&&typeof callbackYes==='function'?function(){hideInformation();callbackYes();}:function(){hideInformation();};setCallbackNo=typeof callbackNo!=='undefined'&&typeof callbackNo==='function'?function(){hideInformation();callbackNo();}:function(){hideInformation();};setCallbackCancel=typeof callbackCancel!=='undefined'&&typeof callbackCancel==='function'?function(){hideInformation();callbackCancel();}:function(){hideInformation();};if(!$('#divInformation').is(':visible')){var header=$('#tableInformation #infoHeader');var content=$('#tableInformation #infoMessage>div');var buttonYes=$('#tableInformation #buttonYes');var buttonNo=$('#tableInformation #buttonNo');var buttonCancel=$('#tableInformation #buttonCancel');buttonYes.off('click');buttonNo.off('click');buttonCancel.off('click');header.html(title);content.html(message);buttonYes.html(btnYesText).click(setCallbackYes);if(btnNoText.length>0)buttonNo.html(btnNoText).show().click(setCallbackNo);else buttonNo.hide();if(btnCancelText.length>0)buttonCancel.html(btnCancelText).show().click(setCallbackCancel);else buttonCancel.hide();$('#divInformation').show();setTimeout(function(){buttonYes.focus();},50);var thisHeight=$('#tableInformation').outerHeight();$('#tableInformation').css("margin-top","-"+(thisHeight/2)+"px");}}
function hideInformation(){$('#divInformation').hide();}
function showHover(title,content,_clickAnywhereToClose){title=typeof title!=='undefined'?title:"Hover";content=typeof content!=='undefined'?$(''+content).html():"";_clickAnywhereToClose=typeof _clickAnywhereToClose!=='undefined'?_clickAnywhereToClose:false;if(!$('#divHover').is(':visible')){var header=$('#tableHover #hoverHeader>span');var container=$('#tableHover #hoverContent');header.html(title);if(content!="")container.html(content);$('#divHover').show();$('#divHover #hoverHeader').removeClass("open");$('#divHover #divHoverMove').find("img").prop("src","images/lock.png");_moveHover=false;repositionHover();$('#divHoverTransparent').off("click");if(_clickAnywhereToClose){$('#divHoverTransparent').click(function(event){if(event.target.id==$(this).prop("id")){hideHover();}});}}}
function repositionHover(){var opened=$('#divHover #hoverHeader').hasClass("open");if(opened==false){var thisHeight=$('#tableHover').outerHeight();var thisWidth=$('#tableHover').outerWidth();$('#tableHover').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");var thisHeight=$('#tableHover').outerHeight();var thisWidth=$('#tableHover').outerWidth();$('#tableHover').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");}}
function hideHover(){$('#divHover').hide();}
function showNewHover(title,content,buttons,contentHeight,_clickAnywhereToClose){title=typeof title!=='undefined'?title:"HOVER";content=typeof content!=='undefined'?$(''+content).html():"";buttons=typeof buttons!=='undefined'?buttons:[];contentHeight=typeof contentHeight!=='undefined'?contentHeight:500;_clickAnywhereToClose=typeof _clickAnywhereToClose!=='undefined'?_clickAnywhereToClose:false;if(!$('#divNewHover').is(':visible')){var header=$('#tableNewHover #hoverNewHeader>span');var container=$('#tableNewHover #hoverNewContent');header.html(title);if(content!="")container.html(content);$('#divNewHover').show();$('#divNewHover #hoverNewHeader').removeClass("open");$('#divNewHover #divNewHoverMove').find("img").prop("src","images/lock.png");_moveNewHover=false;if(buttons.length>0){var content="";for(var i=0;i<buttons.length;i++){if(typeof buttons[i]['name']!=="undefined"&&typeof buttons[i]['class']!="undefined"){content+="<button class='cbutton "+buttons[i]['class']+"'>"+buttons[i]['name']+"</button>";}}
$('#divNewHover #hoverNewButtonContainer').html(content);}else{$('#divNewHover #hoverNewButtonContainer').html("");}
$('#divNewHover #hoverNewContentContainer').css("max-height",contentHeight+"px").css("min-height",contentHeight+"px").height(contentHeight);repositionNewHover();$('#divNewHover #hoverNewContentContainer').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.hoverScrollable").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHover').find('.hoverScrollable').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();var obj=$('#divNewHover #hoverNewContentContainer');obj.scrollTop(obj.scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.divAllowMousewheel").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHoverTransparent').off("click");if(_clickAnywhereToClose){$('#divNewHoverTransparent').click(function(event){if(event.target.id==$(this).prop("id")){hideNewHover();}});}}}
function repositionNewHover(){var opened=$('#divNewHover #hoverNewHeader').hasClass("open");if(opened==false){var thisHeight=$('#tableNewHover').outerHeight();var thisWidth=$('#tableNewHover').outerWidth();$('#tableNewHover').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");var thisHeight=$('#tableNewHover').outerHeight();var thisWidth=$('#tableNewHover').outerWidth();$('#tableNewHover').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");}}
function hideNewHover(){$('#divNewHover').hide();}
function showNewHover2(title,content,buttons,contentHeight,_clickAnywhereToClose){title=typeof title!=='undefined'?title:"HOVER";content=typeof content!=='undefined'?$(''+content).html():"";buttons=typeof buttons!=='undefined'?buttons:[];contentHeight=typeof contentHeight!=='undefined'?contentHeight:500;_clickAnywhereToClose=typeof _clickAnywhereToClose!=='undefined'?_clickAnywhereToClose:false;if(!$('#divNewHover2').is(':visible')){var header=$('#tableNewHover2 #hoverNewHeader2>span');var container=$('#tableNewHover2 #hoverNewContent2');header.html(title);if(content!="")container.html(content);$('#divNewHover2').show();$('#divNewHover2 #hoverNewHeader2').removeClass("open");$('#divNewHover2 #divNewHoverMove2').find("img").prop("src","images/lock.png");_moveNewHover2=false;if(buttons.length>0){var content="";for(var i=0;i<buttons.length;i++){if(typeof buttons[i]['name']!=="undefined"&&typeof buttons[i]['class']!="undefined"){content+="<button class='cbutton "+buttons[i]['class']+"'>"+buttons[i]['name']+"</button>";}}
$('#divNewHover2 #hoverNewButtonContainer2').html(content);}else{$('#divNewHover2 #hoverNewButtonContainer2').html("");}
$('#divNewHover2 #hoverNewContentContainer2').css("max-height",contentHeight+"px").css("min-height",contentHeight+"px").height(contentHeight);repositionNewHover2();$('#divNewHover2 #hoverNewContentContainer2').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.hoverScrollable").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHover2').find('.hoverScrollable').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();var obj=$('#divNewHover2 #hoverNewContentContainer2');obj.scrollTop(obj.scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.divAllowMousewheel").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHoverTransparent2').off("click");if(_clickAnywhereToClose){$('#divNewHoverTransparent2').click(function(event){if(event.target.id==$(this).prop("id")){hideNewHover2();}});}}}
function repositionNewHover2(){var opened=$('#divNewHover2 #hoverNewHeader2').hasClass("open");if(opened==false){var thisHeight=$('#tableNewHover2').outerHeight();var thisWidth=$('#tableNewHover2').outerWidth();$('#tableNewHover2').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");var thisHeight=$('#tableNewHover2').outerHeight();var thisWidth=$('#tableNewHover2').outerWidth();$('#tableNewHover2').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");}}
function hideNewHover2(){$('#divNewHover2').hide();}
function showNewHover3(title,content,buttons,contentHeight,_clickAnywhereToClose){title=typeof title!=='undefined'?title:"HOVER";content=typeof content!=='undefined'?$(''+content).html():"";buttons=typeof buttons!=='undefined'?buttons:[];contentHeight=typeof contentHeight!=='undefined'?contentHeight:500;_clickAnywhereToClose=typeof _clickAnywhereToClose!=='undefined'?_clickAnywhereToClose:false;if(!$('#divNewHover3').is(':visible')){var header=$('#tableNewHover3 #hoverNewHeader3>span');var container=$('#tableNewHover3 #hoverNewContent3');header.html(title);if(content!="")container.html(content);$('#divNewHover3').show();$('#divNewHover3 #hoverNewHeader3').removeClass("open");$('#divNewHover3 #divNewHoverMove3').find("img").prop("src","images/lock.png");_moveNewHover3=false;if(buttons.length>0){var content="";for(var i=0;i<buttons.length;i++){if(typeof buttons[i]['name']!=="undefined"&&typeof buttons[i]['class']!="undefined"){content+="<button class='cbutton "+buttons[i]['class']+"'>"+buttons[i]['name']+"</button>";}}
$('#divNewHover3 #hoverNewButtonContainer3').html(content);}else{$('#divNewHover3 #hoverNewButtonContainer3').html("");}
$('#divNewHover3 #hoverNewContentContainer3').css("max-height",contentHeight+"px").css("min-height",contentHeight+"px").height(contentHeight);repositionNewHover3();$('#divNewHover3 #hoverNewContentContainer3').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.hoverScrollable").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHover3').find('.hoverScrollable').off("mousewheel").on("mousewheel",function(event){if(event.ctrlKey){event.preventDefault();var obj=$('#divNewHover3 #hoverNewContentContainer3');obj.scrollTop(obj.scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}else{if($(event.target).parents('div.autoResultContainer').length>0)return;if($(event.target).is("textarea"))return;if($(event.target).parents("div.chosen-container").length>0)return;if($(event.target).parents("div.divAllowMousewheel").length>0)return;event.preventDefault();$(this).scrollTop($(this).scrollTop()+scroll_speed*(event.originalEvent.wheelDelta/Math.abs(event.originalEvent.wheelDelta))*-1);}});$('#divNewHoverTransparent3').off("click");if(_clickAnywhereToClose){$('#divNewHoverTransparent3').click(function(event){if(event.target.id==$(this).prop("id")){hideNewHover3();}});}}}
function repositionNewHover3(){var opened=$('#divNewHover3 #hoverNewHeader3').hasClass("open");if(opened==false){var thisHeight=$('#tableNewHover3').outerHeight();var thisWidth=$('#tableNewHover3').outerWidth();$('#tableNewHover3').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");var thisHeight=$('#tableNewHover3').outerHeight();var thisWidth=$('#tableNewHover3').outerWidth();$('#tableNewHover3').css("top","50%").css("left","50%").css("margin-left","-"+(thisWidth/2)+"px").css("margin-top","-"+(thisHeight/2)+"px");}}
function hideNewHover3(){$('#divNewHover3').hide();}
function showLoader(){if(!$('#divLoader').is(':visible')){$('#divLoader').show();}}
function hideLoader(){$('#divLoader').hide();}
function gotoPage(filename){showLoader();if($('#divMenu').size()>0){if(filename=="index.php"){setCookie("top_menu",0,1);}else{setCookie("top_menu",$('#divMenu').css("margin-top").replace("px",""),1);}}
location.href=filename;}
function ajaxPost(content,callback,callbackError,_isLoader,timeout_in_sec,_supressInformation){_isLoader=typeof _isLoader!=='undefined'?_isLoader:true;timeout_in_sec=typeof timeout_in_sec!=='undefined'?timeout_in_sec:30;_supressInformation=typeof _supressInformation!=='undefined'?_supressInformation:false;if(_isLoader)showLoader();var text=JSON.stringify(content);var sent=text;if(typeof content['act']!=="undefined"&&content['act']=="login"){var key=generateAuthKey();var iv=forge.random.getBytesSync(16);var cipher=forge.cipher.createCipher('AES-CBC',key);cipher.start({iv:iv});cipher.update(forge.util.createBuffer(text));cipher.finish();var encrypted=cipher.output;sent=version.substr(0,1)+forge.util.bytesToHex(iv).toUpperCase()+encrypted.toHex().toUpperCase();}
$.ajax({type:"POST",url:backend,data:"q="+sent,timeout:timeout_in_sec*1000,}).done(function(resp){if(_isLoader)hideLoader();var result=resp;if(typeof content['act']!=="undefined"&&content['act']=="login"){var key=generateAuthKey();var iv=forge.util.hexToBytes(resp.substr(0,32));var text=forge.util.hexToBytes(resp.substr(32));var decipher=forge.cipher.createDecipher('AES-CBC',key);decipher.start({iv:iv});var decrypt=forge.util.createBuffer(forge.util.decode64(text));decipher.update(decrypt);decipher.finish();result=forge.util.decode64(decipher.output.data);}
try{a=JSON.parse(result);if(a['status']=="29901"||a['status']=="29903"||a['status']=="29905"){showInformation("KESALAHAN",a['message'],"OK","","",function(){if(window.location.href.indexOf("login.php")<0){gotoPage("logout.php");}});}else{callback(result);}}catch(e){console.log(e);if(_supressInformation==false){showInformation("KESALAHAN","TERJADI MASALAH TEKNIS, HUBUNGI ADMINISTRATOR","OK","","",callbackError);}else{if(typeof callbackError==="function")callbackError();}}}).fail(function(resp){console.log(resp);if(_isLoader)hideLoader();if(_supressInformation==false){showInformation("KESALAHAN","TERJADI MASALAH SAAT PENGIRIMAN DATA<br>COBALAH BEBERAPA SAAT LAGI","OK","","",callbackError);}else{if(typeof callbackError==="function")callbackError();}});}
function setDatepicker(el){el=typeof el!=='undefined'?el:".datepicker";$(el).each(function(){if(!$(this).hasClass('monthpicker')){$(this).attr("autocomplete","off").datepicker({dateFormat:'dd-mm-yy',changeMonth:true,changeYear:true,beforeShow:function(i,inst){if($(i).attr('readonly'))return false;inst.dpDiv.removeClass('monthpicker');}}).keydown(function(e){event.preventDefault();});}else{$(this).attr("autocomplete","off").datepicker({dateFormat:'MM yy',changeMonth:true,changeYear:true,showButtonPanel:true,beforeShow:function(i,inst){if($(i).attr('readonly'))return false;inst.dpDiv.addClass('monthpicker');var months=["JANUARI","FEBRUARI","MARET","APRIL","MEI","JUNI","JULI","AGUSTUS","SEPTEMBER","OKTOBER","NOVEMBER","DESEMBER"];var expl=$(i).val().split(" ");if(months.indexOf(expl[0])>=0){$(this).datepicker('option','defaultDate',new Date(expl[1],months.indexOf(expl[0]),1));$(this).datepicker('setDate',new Date(expl[1],months.indexOf(expl[0]),1));}},onClose:function(dateText,inst){$(this).datepicker('setDate',new Date(inst.selectedYear,inst.selectedMonth,1));$(inst.input).trigger("change");}}).keydown(function(e){event.preventDefault();});}});}
function generateAuthKey(){var prefix=["nolzero","satuone","duatwo","tigathree","empatfour","limafive","enamsix","tujuhseven","delapaneight","sembilannine"];if(typeof prefix[version.substr(0,1)*1]!="undefined"){var codename=prefix[version.substr(0,1)*1].substr(0,8);while(codename.length<16)codename+=" ";return codename+"_AMATECH";}
return false;}
function getMonthsName(month,_isShort){_isShort=typeof _isShort!=='undefined'?_isShort:true;var longMonth=["JANUARI","FEBRUARI","MARET","APRIL","MEI","JUNI","JULI","AGUSTUS","SEPTEMBER","OKTOBER","NOVEMBER","DESEMBER"];var shortMonth=["JAN","FEB","MAR","APR","MEI","JUN","JUL","AGT","SEP","OKT","NOV","DES"];return _isShort?(typeof shortMonth[month-1]!=="undefined"?shortMonth[month-1]:"Unk"):(typeof longMonth[month-1]!=="undefined"?longMonth[month-1]:"Unknown");}
Object.mySize=function(obj){var size=0,key;for(key in obj){if(obj.hasOwnProperty(key))size++;}
return size;};function isNumberKey(evt,_decimal){_decimal=typeof _decimal!=='undefined'?_decimal:false;var charCode=(evt.which)?evt.which:event.keyCode;if(_decimal&&(charCode==44||charCode==46))return true;if(charCode>31&&(charCode<48||charCode>57)&&charCode!=45)return false;return true;}
function onkeyFormat(obj){if(!obj.readOnly){val=obj.value;if(val.substr(-1,1)=="."){val=val.substr(0,val.length-1)+",";}
afterDecimal="";if(val.indexOf(",")>=0){afterDecimal=","+val.substr(val.indexOf(",")+1).replace(/,/g,"");val=val.substr(0,val.indexOf(","));}
val=val.replace(/\u002e/g,"");val=val.replace(/,/g,"")*1;if(isNaN(val)||isNaN(afterDecimal.substr(1))){obj.value=0;}else{obj.value=val;val=val+"";for(var i=0;i<Math.floor((val.length-(1+i))/3);i++)val=val.substring(0,val.length-(4*i+3))+'.'+val.substring(val.length-(4*i+3));obj.value=val;if(afterDecimal.length>0){obj.value+=afterDecimal;}}}}
function formatCur(num,decimal){decimal=typeof decimal!=='undefined'?decimal:0;num=(num*1).toFixed(decimal);minus=num.substr(0,1)=="-"?true:false;if(minus)num=num.substr(1);var comma="";if(num.indexOf(".")>=0){comma=num.substr(num.indexOf(".")+1);num=num.substr(0,num.indexOf("."));}
for(var i=0;i<Math.floor((num.length-(1+i))/3);i++)num=num.substring(0,num.length-(4*i+3))+'.'+num.substring(num.length-(4*i+3));if(minus)num="-"+num;if(comma.length>0)num=num+","+comma;return num;}
function properCase(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();});}
function escapeHtml(string){var entityMap={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','/':'&#x2F;','`':'&#x60;','=':'&#x3D;'};return String(string).replace(/[&<>"'`=\/]/g,function(s){return entityMap[s];});}
function addslashes(string){return string.replace(/\\/g,'\\\\').replace(/\u0008/g,'\\b').replace(/\t/g,'\\t').replace(/\n/g,'\\n').replace(/\f/g,'\\f').replace(/\r/g,'\\r').replace(/"/g,'\\"');}
function stripslashes(string){return string.replace(/\\(.)/mg,"$1");}
function showDate(db_date){return db_date.substr(6,2)+"-"+db_date.substr(4,2)+"-"+db_date.substr(0,4);}
function showTime(db_time){return db_time.substr(0,2)+":"+db_time.substr(2,2)+":"+db_time.substr(4,2);}
function setCookie(name,value,days){var expires="";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}
document.cookie=name+"="+(value||"")+expires+"; path=/";}
function getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function validateEmail(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(String(email).toLowerCase());}
function printDocument(printUrl,callback,isDotMatrix,isPaperLess){callback=typeof callback!=='undefined'?callback:function(){};isDotMatrix=typeof isDotMatrix!=='undefined'?isDotMatrix:0;isPaperLess=typeof isPaperLess!=='undefined'?isPaperLess:0;if(isDotMatrix==0){showLoader();$.ajax({type:"GET",url:printUrl,timeout:20000,}).done(function(resp){hideLoader();var result=resp;try{a=JSON.parse(result);if(a['status']=="29901"||a['status']=="29905"){showInformation("KESALAHAN",a['message'],"OK","","",function(){gotoPage("logout.php");});}else{if(a['status']=="00000"){var url="generated/"+a['return']['filename'];if(isPaperLess==0){var iframe=document.createElement('iframe');iframe.className='pdfIframe'
document.body.appendChild(iframe);iframe.style.display='none';iframe.onload=function(){setTimeout(function(){iframe.focus();iframe.contentWindow.print();URL.revokeObjectURL(url)},1);};iframe.src=url;}
else{var link=document.createElement("a");link.href=url;link.download=a['return']['filename'];link.click();}
callback();}else{showInformation("["+a['status']+"] KONFIRMASI",a["message"]+"<br><br>TEKAN OK UNTUK MENCOBA LAGI","OK","TIDAK","",function(){printDocument(printUrl,callback);},function(){callback();});}}}catch(e){console.log(e);showInformation("KONFIRMASI","TERJADI MASALAH TEKNIS, HUBUNGI ADMINISTRATOR<br><br>TEKAN OK UNTUK MENCOBA LAGI","OK","TIDAK","",function(){printDocument(printUrl,callback);},function(){callback();});}}).fail(function(resp){console.log(resp);hideLoader();showInformation("KONFIRMASI","TERJADI MASALAH PADA SAAT PENGIRIMAN DATA<br><br>TEKAN OK UNTUK MENCOBA LAGI","OK","TIDAK","",function(){printDocument(printUrl,callback);},function(){callback();});});}else{showLoader();var url=printUrl;var iframe=document.createElement('iframe');iframe.className='pdfIframe'
document.body.appendChild(iframe);iframe.style.position="absolute";iframe.style.top="0px";iframe.style.left="0px";iframe.style.width="100%";iframe.style.height="100%";iframe.onload=function(){setTimeout(function(){iframe.focus();iframe.style.display="none";iframe.contentWindow.print();URL.revokeObjectURL(url)},1);hideLoader();callback();};iframe.src=url;}}
function toTitleCase(str){return str.replace(/(?:^|\s)\w/g,function(match){return match.toUpperCase();});}
function calculateOGSPrice(price,disc_percent,ppn_percent,pph_percent,exchange_rate,amount){disc_nominal=disc_percent*price/100;dpp=price-disc_nominal;ppn=ppn_percent*dpp/100;pph=pph_percent*dpp/100;subtotal_per_amount_after_tax=dpp+ppn-pph;subtotal_per_amount_after_tax_in_rp=subtotal_per_amount_after_tax*exchange_rate;subtotal_after_tax_in_rp=Math.round(subtotal_per_amount_after_tax_in_rp*amount*100)/100;var result={};result['subtotal_per_amount_after_tax']=subtotal_per_amount_after_tax;result['subtotal_per_amount_after_tax_in_rp']=subtotal_per_amount_after_tax_in_rp;result['subtotal_after_tax_in_rp']=subtotal_after_tax_in_rp;return result;}
function isMobile(){return(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));}